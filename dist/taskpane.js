/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t,e,n,r,s={27091:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},44944:function(t,e,n){t.exports=n.p+"assets/logo-filled.png"},60806:function(t,e,n){t.exports=n.p+"499b224abc73f9895eac.css"}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return s[t](n,n.exports,i),n.exports}i.m=s,i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!t;)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t}(),i.b=document.baseURI||self.location.href,function(){var t={};i.r(t),i.d(t,{APIConnectionError:function(){return x},APIConnectionTimeoutError:function(){return _},APIError:function(){return v},APIUserAbortError:function(){return b},AuthenticationError:function(){return S},BadRequestError:function(){return E},ConflictError:function(){return A},InternalServerError:function(){return k},NotFoundError:function(){return I},OpenAIError:function(){return w},PermissionDeniedError:function(){return P},RateLimitError:function(){return L},UnprocessableEntityError:function(){return O}});const e="4.17.4";let n,r,s,o,a,c,u,l,h,f=!1,d=null,p=null,m=null,y=null;class g{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}n||function(t,e={auto:!1}){if(f)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(n)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${n}'\``);f=e.auto,n=t.kind,r=t.fetch,d=t.Request,p=t.Response,m=t.Headers,s=t.FormData,y=t.Blob,o=t.File,a=t.ReadableStream,c=t.getMultipartRequestOptions,u=t.getDefaultAgent,l=t.fileFromPath,h=t.isFsReadStream}(function({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,o;try{n=fetch,r=Request,s=Response,o=Headers}catch(t){throw new Error(`this environment is missing the following Web Fetch API type: ${t.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:o,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(t,e)=>({...e,body:new g(t)}),getDefaultAgent:t=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:t=>!1}}(),{auto:!0});class w extends Error{}class v extends w{constructor(t,e,n,r){super(`${v.makeMessage(t,e,n)}`),this.status=t,this.headers=r;const s=e;this.error=s,this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(t,e,n){const r=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,e,n,r){if(!t)return new x({cause:ct(e)});const s=e?.error;return 400===t?new E(t,s,n,r):401===t?new S(t,s,n,r):403===t?new P(t,s,n,r):404===t?new I(t,s,n,r):409===t?new A(t,s,n,r):422===t?new O(t,s,n,r):429===t?new L(t,s,n,r):t>=500?new k(t,s,n,r):new v(t,s,n,r)}}class b extends v{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class x extends v{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class _ extends x{constructor({message:t}={}){super({message:t??"Request timed out."})}}class E extends v{constructor(){super(...arguments),this.status=400}}class S extends v{constructor(){super(...arguments),this.status=401}}class P extends v{constructor(){super(...arguments),this.status=403}}class I extends v{constructor(){super(...arguments),this.status=404}}class A extends v{constructor(){super(...arguments),this.status=409}}class O extends v{constructor(){super(...arguments),this.status=422}}class L extends v{constructor(){super(...arguments),this.status=429}}class k extends v{}class R{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let n=!1;const r=new C;return new R((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let s=!1;try{for await(const n of async function*(){if(!t.body)throw e.abort(),new w("Attempted to iterate over a response with no body");const n=new $,s=j(t.body);for await(const t of s)for(const e of n.decode(t)){const t=r.decode(e);t&&(yield t)}for(const t of n.flush()){const e=r.decode(t);e&&(yield e)}}())if(!s)if(n.data.startsWith("[DONE]"))s=!0;else if(null===n.event){let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if(t&&t.error)throw new v(void 0,t.error,void 0,void 0);yield t}s=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{s||e.abort()}}),e)}static fromReadableStream(t,e){let n=!1;return new R((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const e of async function*(){const e=new $,n=j(t);for await(const t of n)for(const n of e.decode(t))yield n;for(const t of e.flush())yield t}())r||e&&(yield JSON.parse(e));r=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{r||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();t.push(r),e.push(r)}return r.shift()}});return[new R((()=>r(t)),this.controller),new R((()=>r(e)),this.controller)]}toReadableStream(){const t=this;let e;const n=new TextEncoder;return new a({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:r,done:s}=await e.next();if(s)return t.close();const o=n.encode(JSON.stringify(r)+"\n");t.enqueue(o)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}class C{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,n,r]=function(t,e){const n=t.indexOf(":");return-1!==n?[t.substring(0,n),":",t.substring(n+1)]:[t,"",""]}(t);return r.startsWith(" ")&&(r=r.substring(1)),"event"===e?this.event=r:"data"===e&&this.data.push(r),null}}class ${constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const n=$.NEWLINE_CHARS.has(e[e.length-1]||"");let r=e.split($.NEWLINE_REGEXP);return 1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if("undefined"!=typeof Buffer){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new w(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new w(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new w("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}function j(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}$.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","Â…","\u2028","\u2029"]),$.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;const T=t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob,B=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;async function N(t,e,n={}){if(t=await t,T(t)){const r=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new o([r],e,n)}const r=await async function(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(B(t))e.push(await t.arrayBuffer());else{if(!M(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${function(t){return`[${Object.getOwnPropertyNames(t).map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const n of t)e.push(n)}return e}(t);if(e||(e=function(t){return F(t.name)||F(t.filename)||F(t.path)?.split(/[\\/]/).pop()}(t)??"unknown_file"),!n.type){const t=r[0]?.type;"string"==typeof t&&(n={...n,type:t})}return new o(r,e,n)}const F=t=>"string"==typeof t?t:"undefined"!=typeof Buffer&&t instanceof Buffer?String(t):void 0,M=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],q=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag],W=async t=>{const e=await U(t.body);return c(e,t)},U=async t=>{const e=new s;return await Promise.all(Object.entries(t||{}).map((([t,n])=>D(e,t,n)))),e},D=async(t,e,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)t.append(e,String(n));else if((t=>(t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&B(t))(t)||T(t)||h(t))(n)){const r=await N(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>D(t,e+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>D(t,`${e}[${n}]`,r))))}}};var X;async function G(t){const{response:e}=t;if(t.options.stream)return ht("response",e.status,e.url,e.headers,e.body),R.fromSSEResponse(e,t.controller);if(204===e.status)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if(n?.includes("application/json")){const t=await e.json();return ht("response",e.status,e.url,e.headers,t),t}const r=await e.text();return ht("response",e.status,e.url,e.headers,r),r}class J extends Promise{constructor(t,e=G){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new J(this.responsePromise,(async e=>t(await this.parseResponse(e))))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class H{constructor({baseURL:t,maxRetries:e=2,timeout:n=6e5,httpAgent:s,fetch:o}){this.baseURL=t,this.maxRetries=at("maxRetries",e),this.timeout=at("timeout",n),this.httpAgent=s,this.fetch=o??r}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...nt(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${ft()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,n){return this.request(Promise.resolve(n).then((n=>({method:t,path:e,...n}))))}getAPIList(t,e,n){return this.requestAPIList(e,{method:"get",path:t,...n})}calculateContentLength(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}return null}buildRequest(t){const{method:e,path:r,query:s,headers:o={}}=t,i=q(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,a=this.calculateContentLength(i),c=this.buildURL(r,s);"timeout"in t&&at("timeout",t.timeout);const l=t.timeout??this.timeout,h=t.httpAgent??this.httpAgent??u(c),f=l+1e3;"number"==typeof h?.options?.timeout&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&"get"!==e&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const d={...a&&{"Content-Length":a},...this.defaultHeaders(t),...o};q(t.body)&&"node"!==n&&delete d["Content-Type"],Object.keys(d).forEach((t=>null===d[t]&&delete d[t]));const p={method:e,...i&&{body:i},headers:d,...h&&{agent:h},signal:t.signal??null};return this.validateHeaders(d,o),{req:p,url:c,timeout:l}}async prepareRequest(t,{url:e,options:n}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,n,r){return v.generate(t,e,n,r)}request(t,e=null){return new J(this.makeRequest(t,e))}async makeRequest(t,e){const n=await t;null==e&&(e=n.maxRetries??this.maxRetries);const{req:r,url:s,timeout:o}=this.buildRequest(n);if(await this.prepareRequest(r,{url:s,options:n}),ht("request",s,n,r.headers),n.signal?.aborted)throw new b;const i=new AbortController,a=await this.fetchWithTimeout(s,r,o,i).catch(ct);if(a instanceof Error){if(n.signal?.aborted)throw new b;if(e)return this.retryRequest(n,e);if("AbortError"===a.name)throw new _;throw new x({cause:a})}const c=Y(a.headers);if(!a.ok){if(e&&this.shouldRetry(a))return this.retryRequest(n,e,c);const t=await a.text().catch((t=>ct(t).message)),r=rt(t),o=r?void 0:t;throw ht("response",a.status,s,c,o),this.makeStatusError(a.status,r,o,c)}return{response:a,options:n,controller:i}}requestAPIList(t,e){const n=this.makeRequest(e,null);return new V(this,n,t)}buildURL(t,e){const n=ot(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),r=this.defaultQuery();return lt(r)||(e={...r,...e}),e&&(n.search=this.stringifyQuery(e)),n.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new w(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,n,r){const{signal:s,...o}=e||{};s&&s.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,t,{signal:r.signal,...o}).finally((()=>{clearTimeout(i)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||409===t.status||429===t.status||t.status>=500)}async retryRequest(t,e,n){let r;const s=n?.["retry-after"];if(s){const t=parseInt(s);r=Number.isNaN(t)?Date.parse(s)-Date.now():1e3*t}if(!r||!Number.isInteger(r)||r<=0||r>6e4){const n=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(e,n)}return await it(r),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const n=e-t;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${e}`}}class K{constructor(t,e,n,r){X.set(this,void 0),function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?s.call(t,n):s?s.value=n:e.set(t,n)}(this,X,t,"f"),this.options=r,this.response=e,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new w("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const e={...this.options};if("params"in t)e.query={...e.query,...t.params};else if("url"in t){const n=[...Object.entries(e.query||{}),...t.url.searchParams.entries()];for(const[e,r]of n)t.url.searchParams.set(e,r);e.query=void 0,e.path=t.url.toString()}return await function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}(this,X,"f").requestAPIList(this.constructor,e)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(X=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class V extends J{constructor(t,e,n){super(e,(async e=>new n(t,e.response,await G(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const Y=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const n=e.toString();return t[n.toLowerCase()]||t[n]}}),z={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0},Q=t=>"object"==typeof t&&null!==t&&!lt(t)&&Object.keys(t).every((t=>function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(z,t))),Z=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",tt=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let et;const nt=()=>et??(et=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":tt(Deno.build.os),"X-Stainless-Arch":Z(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":tt(process.platform),"X-Stainless-Arch":Z(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const t=n.exec(navigator.userAgent);if(t)return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),rt=t=>{try{return JSON.parse(t)}catch(t){return}},st=new RegExp("^(?:[a-z]+:)?//","i"),ot=t=>st.test(t),it=t=>new Promise((e=>setTimeout(e,t))),at=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new w(`${t} must be an integer`);if(e<0)throw new w(`${t} must be a positive integer`);return e},ct=t=>t instanceof Error?t:new Error(t),ut=t=>"undefined"!=typeof process?process.env?.[t]??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(t):void 0;function lt(t){if(!t)return!0;for(const e in t)return!1;return!0}function ht(t,...e){"undefined"!=typeof process&&"true"===process.env.DEBUG&&console.log(`OpenAI:DEBUG:${t}`,...e)}const ft=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));class dt extends K{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data,this.object=n.object}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}}class pt extends K{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data}getPaginatedItems(){return this.data}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const e=Object.fromEntries(t.url.searchParams);return Object.keys(e).length?e:null}nextPageInfo(){if(!this.data?.length)return null;const t=this.data[this.data.length-1]?.id;return t?{params:{after:t}}:null}}class mt{constructor(t){this.client=t,this.get=t.get.bind(t),this.post=t.post.bind(t),this.patch=t.patch.bind(t),this.put=t.put.bind(t),this.delete=t.delete.bind(t),this.getAPIList=t.getAPIList.bind(t)}}class yt extends mt{create(t,e){return this.post("/completions",{body:t,...e,stream:t.stream??!1})}}yt||(yt={});class gt extends mt{create(t,e){return this.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}}gt||(gt={});class wt extends mt{constructor(){super(...arguments),this.completions=new gt(this.client)}}!function(t){t.Completions=gt}(wt||(wt={}));class vt extends mt{create(t,e){return this.post("/edits",{body:t,...e})}}vt||(vt={});class bt extends mt{create(t,e){return this.post("/embeddings",{body:t,...e})}}bt||(bt={});class xt extends mt{create(t,e){return this.post("/files",W({body:t,...e}))}retrieve(t,e){return this.get(`/files/${t}`,e)}list(t={},e){return Q(t)?this.list({},t):this.getAPIList("/files",_t,{query:t,...e})}del(t,e){return this.delete(`/files/${t}`,e)}content(t,e){return this.get(`/files/${t}/content`,{...e,__binaryResponse:!0})}retrieveContent(t,e){return this.get(`/files/${t}/content`,{...e,headers:{Accept:"application/json",...e?.headers}})}async waitForProcessing(t,{pollInterval:e=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(t);for(;!o.status||!r.has(o.status);)if(await it(e),o=await this.retrieve(t),Date.now()-s>n)throw new _({message:`Giving up on waiting for file ${t} to finish processing after ${n} milliseconds.`});return o}}class _t extends dt{}!function(t){t.FileObjectsPage=_t}(xt||(xt={}));class Et extends mt{createVariation(t,e){return this.post("/images/variations",W({body:t,...e}))}edit(t,e){return this.post("/images/edits",W({body:t,...e}))}generate(t,e){return this.post("/images/generations",{body:t,...e})}}Et||(Et={});class St extends mt{create(t,e){return this.post("/audio/speech",{body:t,...e,__binaryResponse:!0})}}St||(St={});class Pt extends mt{create(t,e){return this.post("/audio/transcriptions",W({body:t,...e}))}}Pt||(Pt={});class It extends mt{create(t,e){return this.post("/audio/translations",W({body:t,...e}))}}It||(It={});class At extends mt{constructor(){super(...arguments),this.transcriptions=new Pt(this.client),this.translations=new It(this.client),this.speech=new St(this.client)}}!function(t){t.Transcriptions=Pt,t.Translations=It,t.Speech=St}(At||(At={}));class Ot extends mt{create(t,e){return this.post("/moderations",{body:t,...e})}}Ot||(Ot={});class Lt extends mt{retrieve(t,e){return this.get(`/models/${t}`,e)}list(t){return this.getAPIList("/models",kt,t)}del(t,e){return this.delete(`/models/${t}`,e)}}class kt extends dt{}!function(t){t.ModelsPage=kt}(Lt||(Lt={}));class Rt extends mt{create(t,e){return this.post("/fine_tuning/jobs",{body:t,...e})}retrieve(t,e){return this.get(`/fine_tuning/jobs/${t}`,e)}list(t={},e){return Q(t)?this.list({},t):this.getAPIList("/fine_tuning/jobs",Ct,{query:t,...e})}cancel(t,e){return this.post(`/fine_tuning/jobs/${t}/cancel`,e)}listEvents(t,e={},n){return Q(e)?this.listEvents(t,{},e):this.getAPIList(`/fine_tuning/jobs/${t}/events`,$t,{query:e,...n})}}class Ct extends pt{}class $t extends pt{}!function(t){t.FineTuningJobsPage=Ct,t.FineTuningJobEventsPage=$t}(Rt||(Rt={}));class jt extends mt{constructor(){super(...arguments),this.jobs=new Rt(this.client)}}!function(t){t.Jobs=Rt,t.FineTuningJobsPage=Ct,t.FineTuningJobEventsPage=$t}(jt||(jt={}));class Tt extends mt{create(t,e){return this.post("/fine-tunes",{body:t,...e})}retrieve(t,e){return this.get(`/fine-tunes/${t}`,e)}list(t){return this.getAPIList("/fine-tunes",Bt,t)}cancel(t,e){return this.post(`/fine-tunes/${t}/cancel`,e)}listEvents(t,e,n){return this.get(`/fine-tunes/${t}/events`,{query:e,timeout:864e5,...n,stream:e?.stream??!1})}}class Bt extends dt{}!function(t){t.FineTunesPage=Bt}(Tt||(Tt={}));class Nt extends mt{create(t,e,n){return this.post(`/assistants/${t}/files`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(t,e,n){return this.get(`/assistants/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(t,e={},n){return Q(e)?this.list(t,{},e):this.getAPIList(`/assistants/${t}/files`,Ft,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}del(t,e,n){return this.delete(`/assistants/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}class Ft extends pt{}!function(t){t.AssistantFilesPage=Ft}(Nt||(Nt={}));class Mt extends mt{constructor(){super(...arguments),this.files=new Nt(this.client)}create(t,e){return this.post("/assistants",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}retrieve(t,e){return this.get(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}update(t,e,n){return this.post(`/assistants/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(t={},e){return Q(t)?this.list({},t):this.getAPIList("/assistants",qt,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}del(t,e){return this.delete(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}}class qt extends pt{}function Wt(t){return"function"==typeof t.parse}!function(t){t.AssistantsPage=qt,t.Files=Nt,t.AssistantFilesPage=Ft}(Mt||(Mt={}));const Ut=t=>"assistant"===t?.role,Dt=t=>"function"===t?.role;var Xt,Gt,Jt,Ht,Kt,Vt,Yt,zt,Qt,Zt,te,ee,ne,re,se,oe,ie,ae,ce,ue,le=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},he=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};const fe=10;class de{constructor(){Xt.add(this),this.controller=new AbortController,Gt.set(this,void 0),Jt.set(this,(()=>{})),Ht.set(this,(()=>{})),Kt.set(this,void 0),Vt.set(this,(()=>{})),Yt.set(this,(()=>{})),zt.set(this,{}),this._chatCompletions=[],this.messages=[],Qt.set(this,!1),Zt.set(this,!1),te.set(this,!1),ee.set(this,!1),ae.set(this,(t=>{if(le(this,Zt,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new b),t instanceof b)return le(this,te,!0,"f"),this._emit("abort",t);if(t instanceof w)return this._emit("error",t);if(t instanceof Error){const e=new w(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new w(String(t)))})),le(this,Gt,new Promise(((t,e)=>{le(this,Jt,t,"f"),le(this,Ht,e,"f")})),"f"),le(this,Kt,new Promise(((t,e)=>{le(this,Vt,t,"f"),le(this,Yt,e,"f")})),"f"),he(this,Gt,"f").catch((()=>{})),he(this,Kt,"f").catch((()=>{}))}_run(t){setTimeout((()=>{t().then((()=>{this._emitFinal(),this._emit("end")}),he(this,ae,"f"))}),0)}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const e=t.choices[0]?.message;return e&&this._addMessage(e),t}_addMessage(t,e=!0){if(this.messages.push(t),e)if(this._emit("message",t),(Dt(t)||(t=>"tool"===t?.role)(t))&&t.content)this._emit("functionCallResult",t.content);else if(Ut(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(Ut(t)&&t.tool_calls)for(const e of t.tool_calls)"function"===e.type&&this._emit("functionCall",e.function)}_connected(){this.ended||(he(this,Jt,"f").call(this),this._emit("connect"))}get ended(){return he(this,Qt,"f")}get errored(){return he(this,Zt,"f")}get aborted(){return he(this,te,"f")}abort(){this.controller.abort()}on(t,e){return(he(this,zt,"f")[t]||(he(this,zt,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=he(this,zt,"f")[t];if(!n)return this;const r=n.findIndex((t=>t.listener===e));return r>=0&&n.splice(r,1),this}once(t,e){return(he(this,zt,"f")[t]||(he(this,zt,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,n)=>{le(this,ee,!0,"f"),"error"!==t&&this.once("error",n),this.once(t,e)}))}async done(){le(this,ee,!0,"f"),await he(this,Kt,"f")}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new w("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),he(this,Xt,"m",ne).call(this)}async finalMessage(){return await this.done(),he(this,Xt,"m",re).call(this)}async finalFunctionCall(){return await this.done(),he(this,Xt,"m",se).call(this)}async finalFunctionCallResult(){return await this.done(),he(this,Xt,"m",oe).call(this)}async totalUsage(){return await this.done(),he(this,Xt,"m",ie).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(t,...e){if(he(this,Qt,"f"))return;"end"===t&&(le(this,Qt,!0,"f"),he(this,Vt,"f").call(this));const n=he(this,zt,"f")[t];if(n&&(he(this,zt,"f")[t]=n.filter((t=>!t.once)),n.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return he(this,ee,"f")||n?.length||Promise.reject(t),he(this,Ht,"f").call(this,t),he(this,Yt,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];he(this,ee,"f")||n?.length||Promise.reject(t),he(this,Ht,"f").call(this,t),he(this,Yt,"f").call(this,t),this._emit("end")}}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=this.messages[this.messages.length-1];e&&this._emit("finalMessage",e);const n=he(this,Xt,"m",ne).call(this);n&&this._emit("finalContent",n);const r=he(this,Xt,"m",se).call(this);r&&this._emit("finalFunctionCall",r);const s=he(this,Xt,"m",oe).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some((t=>t.usage))&&this._emit("totalUsage",he(this,Xt,"m",ie).call(this))}async _createChatCompletion(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),he(this,Xt,"m",ce).call(this,e);const s=await t.create({...e,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(s)}async _runChatCompletion(t,e,n){for(const t of e.messages)this._addMessage(t,!1);return await this._createChatCompletion(t,e,n)}async _runFunctions(t,e,n){const r="function",{function_call:s="auto",stream:o,...i}=e,a="string"!=typeof s&&s?.name,{maxChatCompletions:c=fe}=n||{},u={};for(const t of e.functions)u[t.name||t.function.name]=t;const l=e.functions.map((t=>({name:t.name||t.function.name,parameters:t.parameters,description:t.description})));for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,function_call:s,functions:l,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new w("missing message in ChatCompletion response");if(!o.function_call)return;const{name:c,arguments:h}=o.function_call,f=u[c];if(!f){const t=`Invalid function_call: ${JSON.stringify(c)}. Available options are: ${l.map((t=>JSON.stringify(t.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:c,content:t});continue}if(a&&a!==c){const t=`Invalid function_call: ${JSON.stringify(c)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,name:c,content:t});continue}let d;try{d=Wt(f)?await f.parse(h):h}catch(t){this._addMessage({role:r,name:c,content:t instanceof Error?t.message:String(t)});continue}const p=await f.function(d,this),m=he(this,Xt,"m",ue).call(this,p);if(this._addMessage({role:r,name:c,content:m}),a)return}}async _runTools(t,e,n){const r="tool",{tool_choice:s="auto",stream:o,...i}=e,a="string"!=typeof s&&s?.function?.name,{maxChatCompletions:c=fe}=n||{},u={};for(const t of e.tools)"function"===t.type&&(u[t.function.name||t.function.function.name]=t.function);const l="tools"in e?e.tools.map((t=>"function"===t.type?{type:"function",function:{name:t.function.name||t.function.function.name,parameters:t.function.parameters,description:t.function.description}}:t)):void 0;for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,tool_choice:s,tools:l,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new w("missing message in ChatCompletion response");if(!o.tool_calls)return;for(const t of o.tool_calls){if("function"!==t.type)continue;const e=t.id,{name:n,arguments:s}=t.function,o=u[n];if(!o){const t=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${l.map((t=>JSON.stringify(t.function.name))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}if(a&&a!==n){const t=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}let i;try{i=Wt(o)?await o.parse(s):s}catch(t){const n=t instanceof Error?t.message:String(t);this._addMessage({role:r,tool_call_id:e,content:n});continue}const c=await o.function(i,this),h=he(this,Xt,"m",ue).call(this,c);if(this._addMessage({role:r,tool_call_id:e,content:h}),a)return}}}}Gt=new WeakMap,Jt=new WeakMap,Ht=new WeakMap,Kt=new WeakMap,Vt=new WeakMap,Yt=new WeakMap,zt=new WeakMap,Qt=new WeakMap,Zt=new WeakMap,te=new WeakMap,ee=new WeakMap,ae=new WeakMap,Xt=new WeakSet,ne=function(){return he(this,Xt,"m",re).call(this).content},re=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(Ut(e))return e}throw new w("stream ended without producing a ChatCompletionMessage with role=assistant")},se=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Ut(e)&&e?.function_call)return e.function_call}},oe=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Dt(e)&&null!=e.content)return e.content}},ie=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},ce=function(t){if(null!=t.n&&t.n>1)throw new w("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ue=function(t){return"string"==typeof t?t:void 0===t?"undefined":JSON.stringify(t)};class pe extends de{static runFunctions(t,e,n){const r=new pe;return r._run((()=>r._runFunctions(t,e,n))),r}static runTools(t,e,n){const r=new pe;return r._run((()=>r._runTools(t,e,n))),r}_addMessage(t){super._addMessage(t),Ut(t)&&t.content&&this._emit("content",t.content)}}var me,ye,ge,we,ve,be,xe,_e=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},Ee=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n};class Se extends de{constructor(){super(...arguments),me.add(this),ye.set(this,void 0)}get currentChatCompletionSnapshot(){return _e(this,ye,"f")}static fromReadableStream(t){const e=new Se;return e._run((()=>e._fromReadableStream(t))),e}static createChatCompletion(t,e,n){const r=new Se;return r._run((()=>r._runChatCompletion(t,{...e,stream:!0},n))),r}async _createChatCompletion(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),_e(this,me,"m",ge).call(this);const s=await t.create({...e,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const t of s)_e(this,me,"m",we).call(this,t);if(s.controller.signal?.aborted)throw new b;return this._addChatCompletion(_e(this,me,"m",ve).call(this))}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),_e(this,me,"m",ge).call(this),this._connected();const r=R.fromReadableStream(t,this.controller);let s;for await(const t of r)s&&s!==t.id&&this._addChatCompletion(_e(this,me,"m",ve).call(this)),_e(this,me,"m",we).call(this,t),s=t.id;if(r.controller.signal?.aborted)throw new b;return this._addChatCompletion(_e(this,me,"m",ve).call(this))}[(ye=new WeakMap,me=new WeakSet,ge=function(){this.ended||Ee(this,ye,void 0,"f")},we=function(t){if(this.ended)return;const e=_e(this,me,"m",be).call(this,t);this._emit("chunk",t,e);const n=t.choices[0]?.delta?.content,r=e.choices[0]?.message;null!=n&&"assistant"===r?.role&&r?.content&&this._emit("content",n,r.content)},ve=function(){if(this.ended)throw new w("stream has ended, this shouldn't happen");const t=_e(this,ye,"f");if(!t)throw new w("request ended without sending any chunks");return Ee(this,ye,void 0,"f"),function(t){const{id:e,choices:n,created:r,model:s}=t;return{id:e,choices:n.map((({message:e,finish_reason:n,index:r})=>{if(!n)throw new w(`missing finish_reason for choice ${r}`);const{content:s=null,function_call:o,tool_calls:i}=e,a=e.role;if(!a)throw new w(`missing role for choice ${r}`);if(o){const{arguments:t,name:e}=o;if(null==t)throw new w(`missing function_call.arguments for choice ${r}`);if(!e)throw new w(`missing function_call.name for choice ${r}`);return{message:{content:s,function_call:{arguments:t,name:e},role:a},finish_reason:n,index:r}}return i?{index:r,finish_reason:n,message:{role:a,content:s,tool_calls:i.map(((e,n)=>{const{function:s,type:o,id:i}=e,{arguments:a,name:c}=s||{};if(null==i)throw new w(`missing choices[${r}].tool_calls[${n}].id\n${Pe(t)}`);if(null==o)throw new w(`missing choices[${r}].tool_calls[${n}].type\n${Pe(t)}`);if(null==c)throw new w(`missing choices[${r}].tool_calls[${n}].function.name\n${Pe(t)}`);if(null==a)throw new w(`missing choices[${r}].tool_calls[${n}].function.arguments\n${Pe(t)}`);return{id:i,type:o,function:{name:c,arguments:a}}}))}}:{message:{content:s,role:a},finish_reason:n,index:r}})),created:r,model:s,object:"chat.completion"}}(t)},be=function(t){var e,n;let r=_e(this,ye,"f");const{choices:s,...o}=t;r?Object.assign(r,o):r=Ee(this,ye,{...o,choices:[]},"f");for(const{delta:s,finish_reason:o,index:i,...a}of t.choices){let t=r.choices[i];if(!t){r.choices[i]={finish_reason:o,index:i,message:s,...a};continue}if(o&&(t.finish_reason=o),Object.assign(t,a),!s)continue;const{content:c,function_call:u,role:l,tool_calls:h}=s;if(c&&(t.message.content=(t.message.content||"")+c),l&&(t.message.role=l),u&&(t.message.function_call?(u.name&&(t.message.function_call.name=u.name),u.arguments&&((e=t.message.function_call).arguments??(e.arguments=""),t.message.function_call.arguments+=u.arguments)):t.message.function_call=u),h){t.message.tool_calls||(t.message.tool_calls=[]);for(const{index:e,id:r,type:s,function:o}of h){const i=(n=t.message.tool_calls)[e]??(n[e]={});r&&(i.id=r),s&&(i.type=s),o&&(i.function??(i.function={arguments:""})),o?.name&&(i.function.name=o.name),o?.arguments&&(i.function.arguments+=o.arguments)}}}return r},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("chunk",(n=>{const r=e.shift();r?r(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t(void 0);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((t=>e.push(t))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0}))}}toReadableStream(){return new R(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Pe(t){return JSON.stringify(t)}class Ie extends Se{static fromReadableStream(t){const e=new Ie;return e._run((()=>e._fromReadableStream(t))),e}static runFunctions(t,e,n){const r=new Ie;return r._run((()=>r._runFunctions(t,e,n))),r}static runTools(t,e,n){const r=new Ie;return r._run((()=>r._runTools(t,e,n))),r}}class Ae extends mt{runFunctions(t,e){return t.stream?Ie.runFunctions(this.client.chat.completions,t,e):pe.runFunctions(this.client.chat.completions,t,e)}runTools(t,e){return t.stream?Ie.runTools(this.client.chat.completions,t,e):pe.runTools(this.client.chat.completions,t,e)}stream(t,e){return Se.createChatCompletion(this.client.chat.completions,t,e)}}class Oe extends mt{constructor(){super(...arguments),this.completions=new Ae(this.client)}}!function(t){t.Completions=Ae}(Oe||(Oe={}));class Le extends mt{retrieve(t,e,n,r){return this.get(`/threads/${t}/messages/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(t,e,n={},r){return Q(n)?this.list(t,e,{},n):this.getAPIList(`/threads/${t}/messages/${e}/files`,ke,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}}class ke extends pt{}!function(t){t.MessageFilesPage=ke}(Le||(Le={}));class Re extends mt{constructor(){super(...arguments),this.files=new Le(this.client)}create(t,e,n){return this.post(`/threads/${t}/messages`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(t,e,n){return this.get(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}update(t,e,n,r){return this.post(`/threads/${t}/messages/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(t,e={},n){return Q(e)?this.list(t,{},e):this.getAPIList(`/threads/${t}/messages`,Ce,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}class Ce extends pt{}!function(t){t.ThreadMessagesPage=Ce,t.Files=Le,t.MessageFilesPage=ke}(Re||(Re={}));class $e extends mt{retrieve(t,e,n,r){return this.get(`/threads/${t}/runs/${e}/steps/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(t,e,n={},r){return Q(n)?this.list(t,e,{},n):this.getAPIList(`/threads/${t}/runs/${e}/steps`,je,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}}class je extends pt{}!function(t){t.RunStepsPage=je}($e||($e={}));class Te extends mt{constructor(){super(...arguments),this.steps=new $e(this.client)}create(t,e,n){return this.post(`/threads/${t}/runs`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}retrieve(t,e,n){return this.get(`/threads/${t}/runs/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}update(t,e,n,r){return this.post(`/threads/${t}/runs/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}list(t,e={},n){return Q(e)?this.list(t,{},e):this.getAPIList(`/threads/${t}/runs`,Be,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}cancel(t,e,n){return this.post(`/threads/${t}/runs/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}submitToolOutputs(t,e,n,r){return this.post(`/threads/${t}/runs/${e}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v1",...r?.headers}})}}class Be extends pt{}!function(t){t.RunsPage=Be,t.Steps=$e,t.RunStepsPage=je}(Te||(Te={}));class Ne extends mt{constructor(){super(...arguments),this.runs=new Te(this.client),this.messages=new Re(this.client)}create(t={},e){return Q(t)?this.create({},t):this.post("/threads",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}retrieve(t,e){return this.get(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}update(t,e,n){return this.post(`/threads/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}del(t,e){return this.delete(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}createAndRun(t,e){return this.post("/threads/runs",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v1",...e?.headers}})}}!function(t){t.Runs=Te,t.RunsPage=Be,t.Messages=Re,t.ThreadMessagesPage=Ce}(Ne||(Ne={}));class Fe extends mt{constructor(){super(...arguments),this.chat=new Oe(this.client),this.assistants=new Mt(this.client),this.threads=new Ne(this.client)}}!function(t){t.Chat=Oe,t.Assistants=Mt,t.AssistantsPage=qt,t.Threads=Ne}(Fe||(Fe={}));class Me extends H{constructor({apiKey:t=ut("OPENAI_API_KEY"),organization:e=ut("OPENAI_ORG_ID")??null,...n}={}){if(void 0===t)throw new w("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const r={apiKey:t,organization:e,...n,baseURL:n.baseURL??"https://api.openai.com/v1"};if(!r.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new w("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:r.baseURL,timeout:r.timeout??6e5,httpAgent:r.httpAgent,maxRetries:r.maxRetries,fetch:r.fetch}),this.completions=new yt(this),this.chat=new wt(this),this.edits=new vt(this),this.embeddings=new bt(this),this.files=new xt(this),this.images=new Et(this),this.audio=new At(this),this.moderations=new Ot(this),this.models=new Lt(this),this.fineTuning=new jt(this),this.fineTunes=new Tt(this),this.beta=new Fe(this),this._options=r,this.apiKey=t,this.organization=e}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}}xe=Me,Me.OpenAI=xe,Me.OpenAIError=w,Me.APIError=v,Me.APIConnectionError=x,Me.APIConnectionTimeoutError=_,Me.APIUserAbortError=b,Me.NotFoundError=I,Me.ConflictError=A,Me.RateLimitError=L,Me.BadRequestError=E,Me.AuthenticationError=S,Me.InternalServerError=k,Me.PermissionDeniedError=P,Me.UnprocessableEntityError=O;const{OpenAIError:qe,APIError:We,APIConnectionError:Ue,APIConnectionTimeoutError:De,APIUserAbortError:Xe,NotFoundError:Ge,ConflictError:Je,RateLimitError:He,BadRequestError:Ke,AuthenticationError:Ve,InternalServerError:Ye,PermissionDeniedError:ze,UnprocessableEntityError:Qe}=t;function Ze(t){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ze(t)}function tn(){tn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),a=new k(r||[]);return s(i,"_invoke",{value:I(t,n,a)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",y={};function g(){}function w(){}function v(){}var b={};u(b,i,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(R([])));_&&_!==n&&r.call(_,i)&&(b=_);var E=v.prototype=g.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(s,o,i,a){var c=h(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==Ze(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,s){n(t,r,e,s)}))}return o=o?o.then(s,s):s()}})}function I(e,n,r){var s=f;return function(o,i){if(s===p)throw new Error("Generator is already running");if(s===m){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=A(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===f)throw s=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=p;var u=h(e,n,r);if("normal"===u.type){if(s=r.done?m:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(s=m,r.method="throw",r.arg=u.arg)}}}function A(e,n){var r=n.method,s=e.iterator[r];if(s===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(s,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function n(){for(;++s<e.length;)if(r.call(e,s))return n.value=e[s],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Ze(e)+" is not iterable")}return w.prototype=v,s(E,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:w,configurable:!0}),w.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),u(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,s,o){void 0===o&&(o=Promise);var i=new P(l(t,n,r,s),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=R,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function s(r,s){return a.type="throw",a.arg=e,n.next=r,s&&(n.method="next",n.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var s=r.arg;L(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function en(t,e,n,r,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,s)}!function(t){t.toFile=N,t.fileFromPath=l,t.Page=dt,t.CursorPage=pt,t.Completions=yt,t.Chat=wt,t.Edits=vt,t.Embeddings=bt,t.Files=xt,t.FileObjectsPage=_t,t.Images=Et,t.Audio=At,t.Moderations=Ot,t.Models=Lt,t.ModelsPage=kt,t.FineTuning=jt,t.FineTunes=Tt,t.FineTunesPage=Bt,t.Beta=Fe}(Me||(Me={}));var nn,rn=new Me({apiKey:"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",dangerouslyAllowBrowser:!0});function sn(t,e){return on.apply(this,arguments)}function on(){var t;return t=tn().mark((function t(e,n){var r,s;return tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="data:image/png;base64,".concat(e),t.next=3,rn.chat.completions.create({model:"gpt-4-vision-preview",messages:[{role:"user",content:[{type:"text",text:n},{type:"image_url",image_url:{url:r}}]}],temperature:.6,max_tokens:1024});case 3:return s=t.sent,t.abrupt("return",s);case 5:case"end":return t.stop()}}),t)})),on=function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function i(t){en(o,r,s,i,a,"next",t)}function a(t){en(o,r,s,i,a,"throw",t)}i(void 0)}))},on.apply(this,arguments)}function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function cn(){cn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),a=new k(r||[]);return s(i,"_invoke",{value:I(t,n,a)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",y={};function g(){}function w(){}function v(){}var b={};u(b,i,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(R([])));_&&_!==n&&r.call(_,i)&&(b=_);var E=v.prototype=g.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(s,o,i,a){var c=h(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==an(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,s){n(t,r,e,s)}))}return o=o?o.then(s,s):s()}})}function I(e,n,r){var s=f;return function(o,i){if(s===p)throw new Error("Generator is already running");if(s===m){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=A(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===f)throw s=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=p;var u=h(e,n,r);if("normal"===u.type){if(s=r.done?m:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(s=m,r.method="throw",r.arg=u.arg)}}}function A(e,n){var r=n.method,s=e.iterator[r];if(s===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(s,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function n(){for(;++s<e.length;)if(r.call(e,s))return n.value=e[s],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(an(e)+" is not iterable")}return w.prototype=v,s(E,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:w,configurable:!0}),w.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),u(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,s,o){void 0===o&&(o=Promise);var i=new P(l(t,n,r,s),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=R,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function s(r,s){return a.type="throw",a.arg=e,n.next=r,s&&(n.method="next",n.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var s=r.arg;L(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function un(t,e,n,r,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,s)}function ln(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function i(t){un(o,r,s,i,a,"next",t)}function a(t){un(o,r,s,i,a,"throw",t)}i(void 0)}))}}function hn(t){return fn.apply(this,arguments)}function fn(){return(fn=ln(cn().mark((function t(e){var n;return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=localStorage.length;null!==localStorage.getItem(n);)console.log("savekey==>",n,"==",localStorage.getItem(n)),n++;localStorage.setItem(n,e),console.log("promptsave",e);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dn(){return pn.apply(this,arguments)}function pn(){return(pn=ln(cn().mark((function t(){var e,n,r,s;return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],n=0;n<localStorage.length;n++)r=localStorage.key(n),s=localStorage.getItem(r),console.log("key===>",r,"prompt==>",s),e.push({key:r,value:s});return console.log("result===>",e),t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mn(t){return mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mn(t)}function yn(){yn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),a=new k(r||[]);return s(i,"_invoke",{value:I(t,n,a)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",y={};function g(){}function w(){}function v(){}var b={};u(b,i,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(R([])));_&&_!==n&&r.call(_,i)&&(b=_);var E=v.prototype=g.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function n(s,o,i,a){var c=h(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==mn(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,i,a)}),(function(t){n("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return n("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,r){function s(){return new e((function(e,s){n(t,r,e,s)}))}return o=o?o.then(s,s):s()}})}function I(e,n,r){var s=f;return function(o,i){if(s===p)throw new Error("Generator is already running");if(s===m){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=A(a,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===f)throw s=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=p;var u=h(e,n,r);if("normal"===u.type){if(s=r.done?m:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(s=m,r.method="throw",r.arg=u.arg)}}}function A(e,n){var r=n.method,s=e.iterator[r];if(s===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(s,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function n(){for(;++s<e.length;)if(r.call(e,s))return n.value=e[s],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(mn(e)+" is not iterable")}return w.prototype=v,s(E,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:w,configurable:!0}),w.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,c,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(P.prototype),u(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,s,o){void 0===o&&(o=Promise);var i=new P(l(t,n,r,s),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),u(E,c,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=R,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function s(r,s){return a.type="throw",a.arg=e,n.next=r,s&&(n.method="next",n.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&r.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var s=r.arg;L(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:R(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function gn(t,e,n,r,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,s)}function wn(t){return function(){var e=this,n=arguments;return new Promise((function(r,s){var o=t.apply(e,n);function i(t){gn(o,r,s,i,a,"next",t)}function a(t){gn(o,r,s,i,a,"throw",t)}i(void 0)}))}}function vn(){return bn.apply(this,arguments)}function bn(){return bn=wn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(function(){var t=wn(yn().mark((function t(e){var n,r,s,o,i,a,c,u,l,h,f,d;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.document.body,nn=En(),"describe-selected"!==document.getElementById("describe-image").value){t.next=24;break}return t.next=5,e.document.getSelection();case 5:return r=t.sent,(s=r.inlinePictures).load("id"),t.next=10,e.sync();case 10:return o=r.inlinePictures.getFirstOrNullObject(),i=o.getBase64ImageSrc(),t.next=14,e.sync();case 14:return a=i.m_value,nn=En(),t.next=18,sn(a,nn);case 18:return c=t.sent,console.log("showdata========>",c),o.insertParagraph(c.choices[0].message.content,"After"),t.next=23,e.sync();case 23:s.items.length>0&&(u=s.items[0],n.insertParagraph("image_R: ".concat(u.__R),Word.InsertLocation.start));case 24:if("describe-all"!==document.getElementById("describe-image").value){t.next=57;break}return t.next=27,e.document.body.inlinePictures.getFirstOrNullObject();case 27:return l=t.sent,t.next=30,e.sync();case 30:return h=l.getBase64ImageSrc(),t.next=33,e.sync();case 33:return f=h.m_value,console.log("imageBase64========>",f),t.next=37,sn(f,nn);case 37:return d=t.sent,console.log("showdata========>",d),l.insertParagraph(d.choices[0].message.content,"After"),t.next=42,e.sync();case 42:if(!1!==l.isNullObject){t.next=57;break}return l=l.getNextOrNullObject(),h=l.getBase64ImageSrc(),t.next=47,e.sync();case 47:return f=h.m_value,console.log("imageBase64========>",f),t.next=51,sn(f,nn);case 51:return d=t.sent,l.insertParagraph(d.choices[0].message.content,"After"),t.next=55,e.sync();case 55:t.next=42;break;case 57:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),bn.apply(this,arguments)}function xn(t){return _n.apply(this,arguments)}function _n(){return(_n=wn(yn().mark((function t(e){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})))).apply(this,arguments)}function En(){var t;t=document.getElementById("prompt-text").value;var e=document.getElementById("book-type").value;"no"!==e&&(t=t+" In the aspect of "+e+".");var n=document.getElementById("client-age").value;return"0-6"===n&&(t+=" with very simple and little words."),"7-12"===n&&(t+=" with simple words."),"13-17"===n&&(t+=" with middle-level words."),"high-level"===n&&(t+=" with senior words."),t+" In "+document.getElementById("language").value}function Sn(){return Pn.apply(this,arguments)}function Pn(){return(Pn=wn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(wn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:hn(document.getElementById("prompt-text").value);case 1:case"end":return t.stop()}}),t)}))));case 2:In();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function In(){return An.apply(this,arguments)}function An(){return(An=wn(yn().mark((function t(){return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Word.run(wn(yn().mark((function t(){var e,n,r;return yn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dn();case 2:for(e=t.sent,document.getElementById("prompt-list").innerHTML="",n=0;n<e.length;n++)(r=document.createElement("option")).textContent=e[n].value,r.value=e[n].key,document.getElementById("prompt-list").appendChild(r);case 5:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function On(){localStorage.clear(),document.getElementById("prompt-list").innerHTML=""}function Ln(){var t=document.getElementById("use-prompt").value;if("use-list"===t){document.getElementById("save-button").hidden=!0;var e=document.getElementById("prompt-list"),n=e.options[e.selectedIndex].text;document.getElementById("prompt-text").value=n}"use-entered"===t&&(document.getElementById("save-button").hidden=!1)}Office.onReady((function(t){t.host===Office.HostType.Word&&(document.getElementById("insert-paragraph").onclick=function(){return xn(vn)},document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("save-button").onclick=function(){return xn(Sn)},document.getElementById("clear-list").onclick=function(){return xn(On)},In(),document.getElementById("use-prompt").onchange=function(){return xn(Ln)},document.getElementById("prompt-list").onchange=function(){return xn(Ln)})}))}(),t=i(27091),e=i.n(t),n=new URL(i(60806),i.b),r=new URL(i(44944),i.b),e()(n),e()(r)}();
//# sourceMappingURL=taskpane.js.map